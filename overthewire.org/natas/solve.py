#!/usr/bin/env python

import requests
import urllib
import array
from base64 import b64encode,b64decode

USER = 'natas11'
PASSWORD = 'CEseCg4EGQwREgQGHwZDSUsUBxJRRU8ABhAGAQ0TUVNPQQcVDwsEB1EU'

#r = requests.Session()
#session = r.get('http://natas11.natas.labs.overthewire.org/', auth=(USER, PASSWORD'))
#print b64decode(urllib.unquote(session.cookies['data'])).encode('hex')

#text_local = 'CEcQGgoDAwQQARIbAQFBSEcNFhZBXkcWFAYMHgoGUV9BUQMSFQMFFEcJ'
text_local = '0847101a0a0303041001121b01014148470d1616415e471614060c1e0a06515f41510312150305144709'
#text_remote = 'ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw='
text_remote = "0a554b221e00482b02044f2503131a70531957685d555a2d121854250355026852115e2c17115e680c"
outText='{\"showpassword\":\"yes\",\"bgcolor\":\"#ffffff\"}'.encode('hex')
tempOut = [0x7b,0x22,0x73,0x68,0x6f,0x77,0x70,0x61,0x73,0x73,0x77,0x6f,0x72,0x64,0x22,0x3a,0x22,0x79,0x65,0x73,0x22,0x2c,0x22,0x62,0x67,0x63,0x6f,0x6c,0x6f,0x72,0x22,0x3a,0x22,0x23,0x66,0x66,0x66,0x66,0x66,0x66,0x22,0x7d]
tempText_remote = [0x0a,0x55,0x4b,0x22,0x1e,0x00,0x48,0x2b,0x02,0x04,0x4f,0x25,0x03,0x13,0x1a,0x70,0x53,0x19,0x57,0x68,0x5d,0x55,0x5a,0x2d,0x12,0x18,0x54,0x25,0x03,0x55,0x02,0x68,0x52,0x11,0x5e,0x2c,0x17,0x11,0x5e,0x68,0x0c]
tempText_local = [0x08,0x47,0x10,0x1a,0x0a,0x03,0x03,0x04,0x10,0x01,0x12,0x1b,0x01,0x01,0x41,0x48,0x47,0x0d,0x16,0x16,0x41,0x5e,0x47,0x16,0x14,0x06,0x0c,0x1e,0x0a,0x06,0x51,0x5f,0x41,0x51,0x03,0x12,0x15,0x03,0x05,0x14,0x47,0x09]

j=0
resp = []
for x in tempText_remote:
    decoded = ( tempOut[j] ^ tempText_remote[j])
    resp.append(hex(decoded))
    j = j + 1

print resp
#print b64decode(text).encode('hex')
#print outText
